<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SportIQ Betting App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;background:#09090b;color:#f9fafb;}
    .app{min-height:100vh;display:flex;flex-direction:column;}
    .header{padding:12px 16px 8px;border-bottom:1px solid #18181b;}
    .title{font-size:18px;font-weight:600;}
    .subtitle{font-size:11px;color:#a1a1aa;margin-top:2px;}
    .main{flex:1;padding:10px 12px 60px;}
    .league{background:#09090b;border-radius:16px;border:1px solid #18181b;margin-bottom:10px;overflow:hidden;}
    .league-header{display:flex;align-items:center;gap:6px;padding:8px 10px;border-bottom:1px solid #18181b;font-size:11px;}
    .league-icon{width:16px;height:16px;border-radius:4px;background:#18181b;display:flex;align-items:center;justify-content:center;font-size:10px;}
    .match-row{display:flex;padding:8px 10px;gap:10px;}
    .match-row+.match-row{border-top:1px solid #18181b;}
    .time{width:52px;font-size:11px;color:#a1a1aa;}
    .status{font-size:10px;color:#f97316;margin-top:2px;}
    .match-main{flex:1;}
    .team-line{display:flex;justify-content:space-between;align-items:center;font-size:13px;margin-bottom:2px;}
    .team-label{display:flex;align-items:center;gap:6px;}
    .logo{width:18px;height:18px;border-radius:999px;background:#18181b;font-size:11px;display:flex;align-items:center;justify-content:center;}
    .score{font-size:14px;font-weight:600;}
    .pred-bar{margin-top:4px;height:6px;border-radius:999px;overflow:hidden;background:#18181b;display:flex;}
    .ph{background:#22c55e;}
    .pd{background:#6b7280;}
    .pa{background:#0ea5e9;}
    .pred-labels{display:flex;justify-content:space-between;font-size:10px;color:#a1a1aa;margin-top:2px;}
    .right{display:flex;flex-direction:column;gap:6px;font-size:11px;color:#a1a1aa;align-items:flex-end;}
    .odds-pill{background:#18181b;border-radius:999px;padding:2px 8px;font-size:11px;}
    .bottom-nav{position:fixed;left:0;right:0;bottom:0;height:52px;border-top:1px solid #18181b;background:#09090b;display:flex;}
    .nav-item{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:10px;color:#71717a;}
    .nav-item span{font-size:16px;}
    .nav-item.active{color:#f9fafb;}
    .msg{font-size:12px;color:#a1a1aa;padding:16px;}
  </style>
</head>
<body>
<div class="app">
  <header class="header">
    <div class="title">SportIQ ‚Äì Torram</div>
    <div class="subtitle">Live odds & predictions (Betting-API.com)</div>
  </header>
  <main class="main">
    <div id="content" class="msg">Loading matches‚Ä¶</div>
  </main>
  <footer class="bottom-nav">
    <div class="nav-item active"><span>üèÄ</span>Games</div>
    <div class="nav-item"><span>‚≠ê</span>Favourites</div>
    <div class="nav-item"><span>üì∞</span>Feed</div>
    <div class="nav-item"><span>üé≤</span>Fantasy</div>
  </footer>
</div>
<script>
async function load() {
  const el = document.getElementById('content');
  try {
    const res = await fetch('/api/matches?sport=football');
    if (!res.ok) throw new Error('HTTP '+res.status);
    const json = await res.json();
    const matches = json.matches || [];
    if (!matches.length) {
      el.innerHTML = '<div class="msg">No matches returned from API.</div>';
      return;
    }
    const byLeague = {};
    matches.forEach(m=>{
      if(!byLeague[m.league]) byLeague[m.league]=[];
      byLeague[m.league].push(m);
    });
    let html = '';
    Object.keys(byLeague).forEach(league=>{
      html += '<section class="league">';
      html += '<div class="league-header"><div class="league-icon">üèÜ</div><div>'+league+'</div></div>';
      byLeague[league].forEach(m=>{
        const h = m.prediction.homeWin, d=m.prediction.draw, a=m.prediction.awayWin;
        const sum = (h||0)+(d||0)+(a||0) || 1;
        const hp = Math.round((h||0)/sum*100);
        const dp = Math.round((d||0)/sum*100);
        const ap = Math.round((a||0)/sum*100);
        html += '<div class="match-row">';
        html += '<div class="time"><div>'+m.startTime+'</div><div class="status">'+m.status+'</div></div>';
        html += '<div class="match-main">';
        html += '<div class="team-line"><div class="team-label"><div class="logo">'+m.homeTeam.name[0]+'</div><span>'+m.homeTeam.name+'</span></div><div class="score">'+(m.score?m.score.home:"")+'</div></div>';
        html += '<div class="team-line"><div class="team-label"><div class="logo">'+m.awayTeam.name[0]+'</div><span>'+m.awayTeam.name+'</span></div><div class="score">'+(m.score?m.score.away:"")+'</div></div>';
        html += '<div class="pred-bar">';
        html += '<div class="ph" style="width:'+hp+'%"></div>';
        if(d) html += '<div class="pd" style="width:'+dp+'%"></div>';
        html += '<div class="pa" style="width:'+ap+'%"></div>';
        html += '</div>';
        html += '<div class="pred-labels"><span>Home '+hp+'%</span>'+(d?'<span>Draw '+dp+'%</span>':'<span></span>')+'<span>Away '+ap+'%</span></div>';
        html += '</div>';
        html += '<div class="right">';
        html += '<div class="odds-pill">H '+(m.odds.home||'-')+'</div>';
        if(m.odds.draw) html += '<div class="odds-pill">D '+m.odds.draw+'</div>';
        html += '<div class="odds-pill">A '+(m.odds.away||'-')+'</div>';
        html += '</div>';
        html += '</div>';
      });
      html += '</section>';
    });
    el.innerHTML = html;
  } catch (err) {
    console.error(err);
    el.innerHTML = '<div class="msg">Failed to load from backend. Make sure server has SPORTS_API_KEY set.</div>';
  }
}
load();
</script>
</body>
</html>
